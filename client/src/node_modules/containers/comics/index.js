import './comics.css'

import React, {Component} from 'react'
import {connect} from 'react-redux'
import {Link} from 'react-router'

import {fetchComics, 
        addComicsToBasket,
        fetchCategories
} from 'actions'
import {getComics} from 'selectors'

class Comics extends Component {
    componentDidMount () {
        this.props.fetchComics()
        this.props.fetchCategories()
    }

    renderComics (comics, index) {
        const {addComicsToBasket} = this.props
        return (
            <div className="comics">
                <div className="comics--tag">
                    {comics.tag}
                </div>
                <div className="comics-block">
                    <img
                        className='comics--img'
                        src={comics.image}
                        alt={comics.name}
                    />
                    <div className="comics-content">
                        <h2 className="comics--name">
                            {comics.name}
                        </h2>
                        <div className="comics-description">
                            <p>{comics.publish}</p>
                            <p>{comics.year}</p>
                            <p>{comics.sheets} страниц</p>
                            <p>{comics.size}</p>
                        </div>
                    </div>
                </div>
                <div className="comics-footer">
                    <div className="comics--price">
                        ${comics.price}
                    </div>
                    <div className="comics-footer-btn">
                        <img
                            onClick={() => addComicsToBasket(comics.id)}
                            className='btn--basket__img'
                            src="/icons/basket.png"
                            alt={comics.name}
                        />
                        <Link
                            to={`/comics/${comics.id}`}
                            className='btn--details'
                        >
                            Детали
                        </Link>
                    </div>
                </div>
            </div>
        )
    }

    render () {
        const {comics} = this.props;
        return (
        <div className="comics-row">
            {comics.map((comic, index) =>
                this.renderComics(comic, index))}
        </div>
        )
    }
}

const mapStateToProps = (state, ownProps) => {
    return {
        comics: getComics(state, ownProps)
    }
}
  

const mapDispatchToProps = {
    fetchComics,
    addComicsToBasket,
    fetchCategories
}

export default connect(mapStateToProps, mapDispatchToProps)(Comics)
