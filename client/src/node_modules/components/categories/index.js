import './categories.css'
import * as R from 'ramda';
import classNames from 'classnames'
import React from 'react'
import {connect} from 'react-redux'
import {Link, withRouter} from 'react-router'
import {compose} from 'redux'
import {getCategories, getActiveCategoryId} from 'selectors'

const Categories = ({categories, activeCategoryId}) => {
    const renderCategory = (category, index) => {
      const getActiveState = R.propEq('id', activeCategoryId)
  
      const linkClass = classNames({
        'categories-group-item': true,
        'categories--active': getActiveState(category)
      })
  
      return (
        <Link
          to={`/categories/${category.id}`}
          className={linkClass}
          key={index}
        >
          {category.name}
        </Link>
      )
    }
  
    const renderAllCategory = () => {
      const linkClass = classNames({
        'categories-group-item': true,
        'categories--active': R.isNil(activeCategoryId)
      })
  
      return (
        <Link
          to='/'
          className={linkClass}
        >
          All
        </Link>
      )
    }
  
    return (
      <div className='categories'>
        <h4 className='categories-name'>Категрии</h4>
        <div className='categories-group'>
          {renderAllCategory()}
          {categories.map((category, index) => renderCategory(category, index))}
        </div>
      </div>
    )
  }
  
  const mapStateToProps = (state, ownProps) => ({
    categories: getCategories(state),
    activeCategoryId: getActiveCategoryId(ownProps)
  })
  
  export default compose(
    withRouter,
    connect(mapStateToProps, null)
  )(Categories)
  